# Summit SEO Amplify - Backend

Backend API for the Summit SEO Amplify platform built with FastAPI and AWS services.

## Technology Stack

- **Framework**: FastAPI
- **Runtime**: Python 3.10+
- **Package Manager**: uv (faster alternative to pip)
- **AWS Services**:
  - AWS Lambda (serverless compute)
  - API Gateway (API management)
  - DynamoDB (database)
  - Cognito (authentication)
  - Step Functions (workflow orchestration)
  - SQS (queueing)
  - OpenSearch Serverless (vector database)
  - Bedrock (generative AI)

## Development Setup

1. **Setup Python Environment with uv**:
   ```bash
   # Install uv (if not already installed)
   # On macOS/Linux:
   curl -LsSf https://astral.sh/uv/install.sh | sh
   # On Windows:
   powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
   
   # Create a virtual environment using uv
   uv venv .venv
   
   # Activate the virtual environment
   # On Windows:
   .venv\Scripts\activate
   # On Unix/MacOS:
   source .venv/bin/activate
   
   # Install dependencies using uv
   uv pip install -r requirements.txt
   
   # For reproducible builds, use the lock file
   uv pip install -r requirements.lock
   ```

2. **Configure AWS Credentials**:
   - Ensure AWS CLI is installed and configured with appropriate credentials
   - Or set environment variables: `AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY`, `AWS_REGION`

3. **Local Development**:
   ```bash
   # Start the FastAPI development server
   cd backend
   uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
   ```

4. **Access API Documentation**:
   - Swagger UI: http://localhost:8000/docs
   - ReDoc: http://localhost:8000/redoc

## Package Management

This project uses `uv` for Python package management:

- **Adding Dependencies**:
  ```bash
  # Add a new dependency
  uv pip install package_name
  
  # Update requirements.txt
  uv pip freeze > requirements.txt
  
  # Update lock file
  uv pip compile requirements.txt -o requirements.lock
  ```

- **Updating Dependencies**:
  ```bash
  # Update all dependencies
  uv pip install -U -r requirements.txt
  
  # Update lock file
  uv pip compile requirements.txt -o requirements.lock
  ```

## Project Structure

```
backend/
├── app/
│   ├── api/                # API routes
│   │   ├── users.py        # User-related endpoints
│   │   ├── tenants.py      # Tenant-related endpoints
│   │   └── ...
│   ├── core/               # Core settings
│   │   └── config.py       # Application configuration
│   ├── db/                 # Database interactions
│   │   └── dynamodb.py     # DynamoDB operations
│   ├── models/             # Pydantic models
│   │   ├── user.py         # User models
│   │   ├── tenant.py       # Tenant models
│   │   └── ...
│   ├── services/           # Business logic services
│   ├── utils/              # Utility functions
│   │   ├── cognito.py      # Cognito JWT verification
│   │   └── security.py     # Security utilities
│   └── main.py             # Application entry point
├── requirements.txt        # Python dependencies
├── requirements.lock       # Locked dependencies generated by uv
└── README.md               # Project documentation
```

## Deployment

For AWS Lambda deployment:

1. Package the application:
   ```bash
   # Create a deployment package (using uv for reproducible builds)
   mkdir -p package
   uv pip install -r requirements.lock --target ./package
   cp -r app ./package/
   cd package
   zip -r ../deployment-package.zip .
   ```

2. Deploy to AWS Lambda:
   ```bash
   aws lambda update-function-code --function-name SummitSeoAmplifyApi --zip-file fileb://deployment-package.zip
   ```

For CI/CD deployment, the process is automated via GitHub Actions or AWS CodePipeline. 